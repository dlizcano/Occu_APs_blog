[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Occupancy in Protected Areas",
    "section": "",
    "text": "The problem\n\n\nUsing the WCS camera trap dataset\n\n\n\nmodel\n\n\n\n\n\n\n\n\n\nMay 20, 2025\n\n\nGerman Forero, Diego J. Lizcano\n\n\n\n\n\n\n\n\n\n\n\n\nFitting a Multi-Species non Spatial Occupancy Model\n\n\nUsing Llanganates subset of the WCS camera trap dataset\n\n\n\nmodel\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\nMay 17, 2025\n\n\nGerman Forero, Galo Zapara-Rios, Diego J. Lizcano\n\n\n\n\n\n\n\n\n\n\n\n\nFitting a Multi-Species Spatial Occupancy Model\n\n\nUsing Llanganates subset of the WCS camera trap dataset\n\n\n\nmodel\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\nMay 15, 2025\n\n\nGerman Forero, Galo Zapara-Rios, Diego J. Lizcano\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2nd_model_1AP/index.html",
    "href": "posts/2nd_model_1AP/index.html",
    "title": "Fitting a Multi-Species non Spatial Occupancy Model",
    "section": "",
    "text": "Multi-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to environmental variables. These models are typically fit using Bayesian frameworks such as BUGS, JAGS, or Nimble. However, preparing the necessary input from camera trapping data, writing the model code, setting parameters to monitor, and providing initial values can be a daunting and time-consuming task, even for experienced users.\ncamtrapR helps using custom funtions to fit community occupancy models for analysis in JAGS or Nimble with several limitations such as: models with categorical observation-level covariates cannot be compiled in Nimble and must be fit in JAGS instead. Priors can not be customized, and independent effects are only supported in continuous site covariates.\nIn terms of speed, Nimble does not seem to have an advantage over JAGS.\n\nCodelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\n#library(spOccupancy)\n\nlibrary(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR)\nlibrary(tidyverse)"
  },
  {
    "objectID": "posts/2nd_model_1AP/index.html#multi-species-occupancy-model-using-camtrapr-package",
    "href": "posts/2nd_model_1AP/index.html#multi-species-occupancy-model-using-camtrapr-package",
    "title": "Fitting a Multi-Species non Spatial Occupancy Model",
    "section": "",
    "text": "Multi-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to environmental variables. These models are typically fit using Bayesian frameworks such as BUGS, JAGS, or Nimble. However, preparing the necessary input from camera trapping data, writing the model code, setting parameters to monitor, and providing initial values can be a daunting and time-consuming task, even for experienced users.\ncamtrapR helps using custom funtions to fit community occupancy models for analysis in JAGS or Nimble with several limitations such as: models with categorical observation-level covariates cannot be compiled in Nimble and must be fit in JAGS instead. Priors can not be customized, and independent effects are only supported in continuous site covariates.\nIn terms of speed, Nimble does not seem to have an advantage over JAGS.\n\nCodelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\n#library(spOccupancy)\n\nlibrary(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR)\nlibrary(tidyverse)"
  },
  {
    "objectID": "posts/2nd_model_1AP/index.html#fitting-a-multi-species-non-spatial-occupancy-model",
    "href": "posts/2nd_model_1AP/index.html#fitting-a-multi-species-non-spatial-occupancy-model",
    "title": "Fitting a Multi-Species non Spatial Occupancy Model",
    "section": "Fitting a Multi-Species non Spatial Occupancy Model",
    "text": "Fitting a Multi-Species non Spatial Occupancy Model\nLlanganates data\nHere we use the tables Ecu-14, Ecu-15 y Ecu-16.\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nAP_Llanganates &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Llanganates/WDPA_WDOECM_May2025_Public_97512_shp-polygons.shp\")\n\n### Ecu 14, Ecu 15  y Ecu 16\n\n# load data and make array_locID column\nEcu_14 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\") |&gt; mutate(array_locID=paste(\"Ecu_14\", locationID, sep=\"_\"))\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 29 deployments in Deployment. \n 29 points in Deployment. \n 29 cameras in Images. \n 29 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodeEcu_15 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")|&gt; mutate(array_locID=paste(\"Ecu_15\", locationID, sep=\"_\"))\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\nWarning in left_join(cameras, deployment): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 6 of `x` matches multiple rows in `y`.\nℹ Row 6 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nWarning in left_join(data1, image, by): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 470 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCodeEcu_16 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")|&gt; mutate(array_locID=paste(\"Ecu_16\", locationID, sep=\"_\"))\n\n28 cameras in Cameras. \n 28 cameras in Deployment. \n 28 deployments in Deployment. \n 28 points in Deployment. \n 28 cameras in Images. \n 28 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCode# get sites\nEcu_14_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_15_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_16_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCode# get elevation map\nelevation_14 &lt;- rast(get_elev_raster(Ecu_14_sites, z = 7)) #z =1-14\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCodebb &lt;-  st_as_sfc(st_bbox(elevation_14)) # make bounding box \n\n\n\n\n# extract covs using points and add to _sites\ncovs_Ecu_14_sites &lt;- cbind(Ecu_14_sites, terra::extract(elevation_14, Ecu_14_sites))\n\ncovs_Ecu_15_sites &lt;- cbind(Ecu_15_sites, terra::extract(elevation_14, Ecu_15_sites))\n\ncovs_Ecu_16_sites &lt;- cbind(Ecu_16_sites, terra::extract(elevation_14, Ecu_16_sites))\n\n# get which are in and out\ncovs_Ecu_14_sites$in_AP = st_intersects(covs_Ecu_14_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_15_sites$in_AP = st_intersects(covs_Ecu_15_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_16_sites$in_AP = st_intersects(covs_Ecu_16_sites, AP_Llanganates, sparse = FALSE)\n\n\n\n# make a map\nmapview (elevation_14, alpha=0.5) + \n  mapview (AP_Llanganates, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Ecu_14_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  mapview (covs_Ecu_15_sites, zcol = \"in_AP\", burst = TRUE, col.regions = c(\"blue\") )+\n  mapview (covs_Ecu_16_sites, zcol = \"in_AP\", burst = TRUE, col.regions =c(\"red\",\"blue\")) \n\n\n\n\n\nCamera trap operation data and detection history\n\nCode# Join 3 tables\nEcu_14_15_16 &lt;- Ecu_14 |&gt; full_join(Ecu_15) |&gt; full_join(Ecu_16)\n\nJoining with `by = join_by(`Project Id`, Camera_Id, Make, Model, `Serial\nNumber`, Year_Purchased, Deployment_ID, Point.x, Longitude, Latitude,\nstart_date, end_date, `Bait Type`, `Bait Description`, `Feature Type`, `Feature\nType methodology`, `Camera Type`, `Quiet Period Setting`, `Restriction on\nAccess`, `Camera Failure Details`, season, rio_playa, arroyo, camino,\nsenda_animal, senda_gente, salitral, pozo_agua, bosque, sabana, intermedio,\nintervalo_trigger, locationID, `Image Id`, `Photo Type`, `Photo Type Identified\nby`, Point.y, scientificName, Date_Time_Captured, `Independent event`, Age,\nSex, `Individual ID`, Count, Jaguar_Design, year, array_locID)`\nJoining with `by = join_by(`Project Id`, Camera_Id, Make, Model, `Serial\nNumber`, Year_Purchased, Deployment_ID, Point.x, Longitude, Latitude,\nstart_date, end_date, `Bait Type`, `Bait Description`, `Feature Type`, `Feature\nType methodology`, `Camera Type`, `Quiet Period Setting`, `Restriction on\nAccess`, `Camera Failure Details`, season, rio_playa, arroyo, camino,\nsenda_animal, senda_gente, salitral, pozo_agua, bosque, sabana, intermedio,\nintervalo_trigger, locationID, `Image Id`, `Photo Type`, `Photo Type Identified\nby`, Point.y, scientificName, Date_Time_Captured, `Independent event`, Age,\nSex, `Individual ID`, Count, Jaguar_Design, year, array_locID)`\n\nCode# fix date format\n# \nEcu_14_15_16$start_date &lt;- as.Date(Ecu_14_15_16$start_date, \"%Y/%m/%d\")\nEcu_14_15_16$end_date &lt;- as.Date(Ecu_14_15_16$end_date, \"%Y/%m/%d\")\nEcu_14_15_16$eventDate &lt;- as.Date(Ecu_14_15_16$Date_Time_Captured, \"%Y-%m-%d\")\n\nWarning in as.POSIXlt.POSIXct(x, tz = tz): unknown timezone '%Y-%m-%d'\n\nCodeEcu_14_15_16$eventDateTime &lt;- ymd_hms(Ecu_14_15_16$Date_Time_Captured)\n\n\n# filter 2021 and make uniques\nCToperation  &lt;- Ecu_14_15_16 |&gt; group_by(array_locID) |&gt; \n                           mutate(minStart=start_date, maxEnd=end_date) |&gt; distinct(Longitude, Latitude, minStart, maxEnd) |&gt; ungroup()\n\n\n# Generamos la matríz de operación de las cámaras\n\ncamop &lt;- cameraOperation(CTtable= CToperation, # Tabla de operación\n                         stationCol= \"array_locID\", # Columna que define la estación\n                         setupCol= \"minStart\", #Columna fecha de colocación\n                         retrievalCol= \"maxEnd\", #Columna fecha de retiro\n                         #hasProblems= T, # Hubo fallos de cámaras\n                         dateFormat= \"%Y-%m-%d\") #, # Formato de las fechas\n                         #cameraCol=\"CT\")\n                         # sessionCol= \"Year\")\n\n# Generar las historias de detección ---------------------------------------\n## remove plroblem species\nind &lt;- which(Ecu_14_15_16$scientificName==\"Set up\")\nEcu_14_15_16 &lt;- Ecu_14_15_16[-ind,]\n\nind &lt;- which(Ecu_14_15_16$scientificName==\"Blank\")\nEcu_14_15_16 &lt;- Ecu_14_15_16[-ind,]\n\nind &lt;- which(Ecu_14_15_16$scientificName==\"Unknown\")\nEcu_14_15_16 &lt;- Ecu_14_15_16[-ind,]\n\n\n\n\n\nDetHist_list &lt;- lapply(unique(Ecu_14_15_16$scientificName), FUN = function(x) {\n  detectionHistory(\n    recordTable         = Ecu_14_15_16, # Tabla de registros\n    camOp                = camop, # Matriz de operación de cámaras\n    stationCol           = \"array_locID\",\n    speciesCol           = \"scientificName\",\n    recordDateTimeCol    = \"eventDateTime\",\n    recordDateTimeFormat  = \"%Y-%m-%d %H:%M:%S\",\n    species              = x,     # la función reemplaza x por cada una de las especies\n    occasionLength       = 7, # Colapso de las historias a 10 ías\n    day1                 = \"station\", # \"survey\" a specific date, \"station\", #inicie en la fecha de cada survey\n    datesAsOccasionNames = FALSE,\n    includeEffort        = TRUE,\n    scaleEffort          = TRUE,\n    #unmarkedMultFrameInput=TRUE\n    timeZone             = \"America/Bogota\" \n    )\n  }\n)\n\n# names\nnames(DetHist_list) &lt;- unique(Ecu_14_15_16$scientificName)\n\n# Finalmente creamos una lista nueva donde estén solo las historias de detección\nylist &lt;- lapply(DetHist_list, FUN = function(x) x$detection_history)\n# otra lista con effort scaled\nefort &lt;- lapply(DetHist_list, FUN = function(x) x$effort)\n\n# Total number of observations for each species\nlapply(ylist, sum, na.rm = TRUE)\n\n$`Dasyprocta fuliginosa`\n[1] 10\n\n$`Cuniculus paca`\n[1] 26\n\n$`Nothocrax urumutum`\n[1] 7\n\n$`Pecari tajacu`\n[1] 30\n\n$`Mazama rufina`\n[1] 19\n\n$`Panthera onca`\n[1] 4\n\n$`Leopardus pardalis`\n[1] 6\n\n$`Cabassous unicinctus`\n[1] 1\n\n$`Dasypus novemcinctus`\n[1] 31\n\n$`Tremarctos ornatus`\n[1] 33\n\n$`Tinamus major`\n[1] 3\n\n$`Canis familiaris`\n[1] 3\n\n$`Homo sapiens`\n[1] 3\n\n$`Hadrosciurus igniventris`\n[1] 2\n\n$`Mazama zamora`\n[1] 4\n\n$`Eira barbara`\n[1] 3\n\n$`Herpailurus yagouaroundi`\n[1] 1\n\n$`Mazama murelia`\n[1] 3\n\n$`Chamaepetes goudotii`\n[1] 1\n\n$`Leopardus wiedii`\n[1] 2\n\n$`Tayassu pecari`\n[1] 1\n\n$`Zentrygon frenata`\n[1] 1\n\n$`Odocoileus ustus`\n[1] 49\n\n$`Sylvilagus andinus`\n[1] 49\n\n$`Nasuella olivacea`\n[1] 5\n\n$`Puma concolor`\n[1] 16\n\n$`Pudu mephistophiles`\n[1] 12\n\n$`Cuniculus taczanowskii`\n[1] 8\n\n$`Tapirus pinchaque`\n[1] 26\n\n$`Leopardus tigrinus`\n[1] 5\n\n$`Pseudalopex culpaeus`\n[1] 39\n\n$`Conepatus semistriatus`\n[1] 3\n\n$`Bos taurus`\n[1] 37\n\n$`Didlephis pernigra`\n[1] 3\n\n$`Penelope montagnii`\n[1] 1\n\n\nArrange spatial covariates\n\nCode# make sf()\nfull_sites_14_15_16_sf &lt;- CToperation |&gt; \n    st_as_sf(coords = c(\"Longitude\", \"Latitude\"), \n              crs = 4326)\n\n# extract elev\nfull_sites_14_15_16_sf$elev &lt;- terra::extract(elevation_14, full_sites_14_15_16_sf)[,2]\nstr(full_sites_14_15_16_sf$elev)\n\n num [1:87] 802 1149 751 646 1051 ...\n\nCode# extract in AP\nfull_sites_14_15_16_sf$in_AP = as.factor(st_intersects(full_sites_14_15_16_sf, AP_Llanganates, sparse = FALSE))\n\nin_AP &lt;- as.numeric(as.vector(st_drop_geometry(full_sites_14_15_16_sf$in_AP)))\n\nWarning: NAs introducidos por coerción\n\nCode# mapview(full_sites_14_15_16_sf, zcol = \"in_AP\", burst = TRUE)\n\n# Transform coord to UTM Z17 Ecuador EPSG:32717 WGS 84 / UTM zone 17S\nfull_sites_14_15_16_sf_UTM &lt;- st_transform(full_sites_14_15_16_sf, \"EPSG:32717\")\n\ncoords &lt;- st_coordinates(full_sites_14_15_16_sf_UTM)\n#str(coords)\n\n# make Ecu_14_15_16 an sf object\n#    cam_sf &lt;- st_as_sf(Ecu_14_15_16, coords = c(\"lon\",\"lat\"))   #crs=\"EPSG:4326\")\n    #--- set CRS ---#\n#    st_crs(cam_sf) &lt;- 4326\n\n#transform llanganates to UTM\nAP_Llanganates_UTM &lt;- st_transform(AP_Llanganates, \"EPSG:32717\")\n# Convert to LINESTRING\nAP_Llanganates_UTM_line &lt;- st_cast(AP_Llanganates_UTM, \"LINESTRING\")\n\nWarning in st_cast.sf(AP_Llanganates_UTM, \"LINESTRING\"): repeating attributes\nfor all sub-geometries for which they may not be constant\n\nCode# Calculate the distance\n#multiplic &lt;- full_sites_14_15_16_sf_UTM |&gt; mutate(multiplic= as.numeric(in_AP)) \nmultiplic=ifelse(full_sites_14_15_16_sf_UTM$in_AP==\"TRUE\",-1,1)\nfull_sites_14_15_16_sf_UTM$border_dist &lt;- as.numeric(st_distance(full_sites_14_15_16_sf_UTM, AP_Llanganates_UTM_line) * multiplic )\n# print(border_dist)\n\nstr(full_sites_14_15_16_sf_UTM$border_dist)\n\n num [1:87] 399 1749 5432 1255 17612 ...\n\n\nPrepare the model\n\nCode# Detection-nondetection data ---------\n# Species of interest, can select individually\n# curr.sp &lt;- sort(unique(Ecu_14_15_16$.id))# c('BAWW', 'BLJA', 'GCFL')\nselected.sp &lt;-  c(\"Canis familiaris\", \n              \"Cuniculus paca\",\n              \"Cuniculus taczanowskii\",\n              \"Dasyprocta fuliginosa\",\n              \"Eira barbara\",\n              \"Herpailurus yagouaroundi\",\n              \"Mazama murelia\",\n              \"Mazama rufina\",\n              \"Mazama zamora\",\n              \"Nasuella olivacea\",\n              \"Odocoileus ustus\",\n              \"Pecari tajacu\",\n              \"Pseudalopex culpaeus\",\n              \"Pudu mephistophiles\",\n              \"Puma concolor\",\n              \"Tapirus pinchaque\",\n              \"Tayassu pecari\",\n              \"Tremarctos ornatus\")\n\n# y.msom &lt;- y[which(sp.codes %in% selected.sp), , ]\n# str(y.msom)\n\n\n#### site covs\nsitecovs &lt;- as.data.frame(st_drop_geometry(\n                    full_sites_14_15_16_sf_UTM[,5:7]))\n sitecovs[, 1] &lt;- as.vector(scale(sitecovs[,1]))   # scale numeric covariates\n sitecovs[, 3] &lt;- as.vector(scale(sitecovs[,3]))   # scale numeric covariates\n # sitecovs$fact &lt;- factor(c(\"A\", \"A\", \"B\"))    # categorical covariate\n\nnames(sitecovs) &lt;- c(\"elev\", \"in_AP\", \"border_dist\")\n\n# check consistancy equal number of spatial covariates and rows in data\n# identical(nrow(ylist[[1]]), nrow(covars)) \n\n# Base de datos para los análisis -----------------------------------------\n\ndata_list &lt;- list(ylist    = ylist, # Historias de detección\n                  siteCovs = sitecovs, #covars, # Covariables de sitio\n                  obsCovs  = list(effort = DetHist_list[[1]]$effort))  # agregamos el esfuerzo de muestreo como covariable de observación\n\n# 3. 1 Modelo multi-especie  -----------------------------------------\n\n# Se creará un txt temporal donde estarán las especificaciones del modelo Bayesiano en JAGS\nmodelfile &lt;- (fileext = \"modoccu.txt\")\n\n# Usaremos la función ` communityModel`\n\n# Generemos el modelo\ncomu_model &lt;- communityModel(data_list, # la lista de datos\n                             occuCovs = list(ranef=c(\"border_dist\", \"elev\", \"in_AP\")), # ranef La covariables de sitio\n                             detCovsObservation = list(fixed = \"effort\"), #Covariables de observación\n                             intercepts = list(det = \"ranef\", occu = \"ranef\"),\n                             # augmentation = c(full = 30),# Número aumentado de especies\n                             modelFile = \"modelfile\")\n\nWrote model to modelfile\n\nCodesummary(comu_model)\n\ncommOccu object for community occupancy model (in JAGS)\n\n35 species,  87 stations,  14 occasions\n685 occasions with effort\nNumber of detections (by species): 1 - 49 \n\nAvailable site covariates:\n elev, in_AP, border_dist \n\nUsed site covariates:\n elev, in_AP, border_dist \n\nAvailable site-occasion covariates:\n effort \n\n\nRunning the model\n\nCode# Running the model\n\nfit.commu &lt;- fit(comu_model,\n                 n.iter = 100000,\n                 n.burnin = 10000,\n                 thin = 50,\n                 chains = 3,\n                 cores = 3,\n                 quiet = T\n);beep(sound = 4)\n\nNOTE: Stopping adaptation\n\nCode# save the results to not run again\nsave(fit.commu, file=\"C:/CodigoR/Occu_APs/Occu_APs_blog/posts/2nd_model_1AP/result/DR_result.R\") # guardamos los resultados para no correr de nuevo\n\n\nResults as table\n\nCode# Resultados --------------------------------------------------------------\n\n# Extraemos lo tabla de valores estimados\nmodresult &lt;- as.data.frame(summary(fit.commu)[[\"statistics\"]])\n# View(modresult)\nDT::datatable(round(summary(fit.commu)$statistics, 3))\n\n\n\n\n\nBayesian p-values can be inspected to check for lack of fit (overall or by species). Lack of fit at significance level = 0.05 is indicated by Bayesian p-values below 0.025 or greater than 0.975. The overall Bayesian p-value (Bpvalue) indicates no problems with lack of fit. Likewise, species-level Bayesian p-values (Bpvalue_species) indicate no lack of fit for any species.\nResults as graph\n\nCode# Gráficos de predicción y de coeficientes\n\n# Otra gran ventaja de CamtrapR es que permite gráficar de manera muy sencilla la predicción posterior del modelo. Veamos que pasa con la ocupación de cada especie\n\nplot_effects(comu_model,\n              fit.commu,\n              submodel = \"det\",\n             combine = T)\n\n$effort\n\n\n\n\n\n\n\nCode# $effort\n\n\nplot_coef(comu_model,\n           fit.commu,\n           submodel = \"state\",\n           combine = T)\n\n'combine' and 'ordered' can't both be TRUE. Setting 'ordered = FALSE'\n\n\n\n\n\n\n\nCode# $occupancy\n\n\n\nplot_effects(comu_model, # El modelo\n             fit.commu, # El objeto ajustado\n             submodel = \"state\",\n             response = \"occupancy\") # el parámetro de interés\n\n$border_dist\n\n\n\n\n\n\n\n\n\n$elev\n\n\n\n\n\n\n\n\n\n$in_AP\n\n\n\n\n\n\n\nCode#&gt; $rough\n#&gt; \n\n\nHere we should see all Rhat values are less than 1.1 and the ESS values indicating adequate mixing of the MCMC chains."
  },
  {
    "objectID": "posts/2nd_model_1AP/index.html#package-citation",
    "href": "posts/2nd_model_1AP/index.html#package-citation",
    "title": "Fitting a Multi-Species non Spatial Occupancy Model",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R version 4.4.2 (R Core Team 2024) and the following R packages: bayesplot v. 1.11.1 (Gabry et al. 2019; Gabry and Mahr 2024), beepr v. 2.0 (Bååth 2024), camtrapR v. 2.3.0 (Niedballa et al. 2016), coda v. 0.19.4.1 (Plummer et al. 2006), DT v. 0.33 (Xie, Cheng, and Tan 2024), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.2.1 (Richard A. Becker, Ray Brownrigg. Enhancements by Thomas P Minka, and Deckmyn. 2024), mapview v. 2.11.2 (Appelhans et al. 2023), rjags v. 4.17 (Plummer 2025), sf v. 1.0.19 (Pebesma 2018; Pebesma and Bivand 2023), snow v. 0.4.4 (Tierney et al. 2021), snowfall v. 1.84.6.3 (Knaus 2023), terra v. 1.8.21 (Hijmans 2025), tictoc v. 1.2.1 (Izrailev 2024), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.0 (Tennekes 2018)."
  },
  {
    "objectID": "posts/2nd_model_1AP/index.html#sesion-info",
    "href": "posts/2nd_model_1AP/index.html#sesion-info",
    "title": "Fitting a Multi-Species non Spatial Occupancy Model",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: internal\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      \n [5] purrr_1.0.2       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     \n [9] ggplot2_3.5.1     tidyverse_2.0.0   camtrapR_2.3.0    snowfall_1.84-6.3\n[13] snow_0.4-4        beepr_2.0         tictoc_1.2.1      bayesplot_1.11.1 \n[17] rjags_4-17        coda_0.19-4.1     elevatr_0.99.0    terra_1.8-21     \n[21] tmap_4.0          maps_3.4.2.1      mapview_2.11.2    sf_1.0-19        \n[25] DT_0.33           readxl_1.4.3      grateful_0.2.10  \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3      rstudioapi_0.17.1       audio_0.1-11           \n  [4] jsonlite_1.8.9          wk_0.9.4                magrittr_2.0.3         \n  [7] farver_2.1.2            rmarkdown_2.29          vctrs_0.6.5            \n [10] base64enc_0.1-3         RcppNumerical_0.6-0     htmltools_0.5.8.1      \n [13] leafsync_0.1.0          progress_1.2.3          curl_6.0.0             \n [16] raster_3.6-30           cellranger_1.1.0        s2_1.1.7               \n [19] sass_0.4.9              slippymath_0.3.1        KernSmooth_2.23-24     \n [22] bslib_0.8.0             htmlwidgets_1.6.4       plyr_1.8.9             \n [25] cachem_1.1.0            stars_0.6-8             uuid_1.2-1             \n [28] lifecycle_1.0.4         pkgconfig_2.0.3         cols4all_0.8           \n [31] Matrix_1.7-1            R6_2.6.1                fastmap_1.2.0          \n [34] digest_0.6.37           colorspace_2.1-1        leafem_0.2.3           \n [37] crosstalk_1.2.1         labeling_0.4.3          lwgeom_0.2-14          \n [40] progressr_0.15.0        spacesXYZ_1.3-0         timechange_0.3.0       \n [43] httr_1.4.7              abind_1.4-8             mgcv_1.9-1             \n [46] compiler_4.4.2          microbenchmark_1.5.0    proxy_0.4-27           \n [49] withr_3.0.2             brew_1.0-10             DBI_1.2.3              \n [52] MASS_7.3-61             tmaptools_3.2           leaflet_2.2.2          \n [55] classInt_0.4-10         tools_4.4.2             units_0.8-5            \n [58] leaflegend_1.2.1        glue_1.8.0              satellite_1.0.5        \n [61] nlme_3.1-166            grid_4.4.2              reshape2_1.4.4         \n [64] generics_0.1.3          gtable_0.3.6            leaflet.providers_2.0.0\n [67] tzdb_0.4.0              class_7.3-22            data.table_1.16.4      \n [70] hms_1.1.3               sp_2.1-4                pillar_1.10.1          \n [73] splines_4.4.2           lattice_0.22-6          tidyselect_1.2.1       \n [76] knitr_1.49              svglite_2.1.3           stats4_4.4.2           \n [79] xfun_0.49               leafpop_0.1.0           stringi_1.8.4          \n [82] rematch_2.0.0           yaml_2.3.10             evaluate_1.0.1         \n [85] codetools_0.2-20        cli_3.6.3               RcppParallel_5.1.9     \n [88] systemfonts_1.1.0       munsell_0.5.1           jquerylib_0.1.4        \n [91] secr_5.1.0              dichromat_2.0-0.1       Rcpp_1.0.13-1          \n [94] png_0.1-8               XML_3.99-0.17           parallel_4.4.2         \n [97] prettyunits_1.2.0       viridisLite_0.4.2       mvtnorm_1.3-2          \n[100] scales_1.3.0            e1071_1.7-16            crayon_1.5.3           \n[103] rlang_1.1.4"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/1st_model_1AP/index.html",
    "href": "posts/1st_model_1AP/index.html",
    "title": "Llanganates",
    "section": "",
    "text": "Codelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\nlibrary(spOccupancy)\nlibrary(bayesplot)\n#library(ggmcmc)\n\nlibrary(tidyverse)\n\n\n\n\n\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nCargando paquete requerido: camtrapR\n\nCodeAP_Llanganates &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Llanganates/WDPA_WDOECM_May2025_Public_97512_shp-polygons.shp\")\n\n### Ecu 14, Ecu 14  y Ecu 16\n\n# load data\nEcu_14 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\")\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 29 deployments in Deployment. \n 29 points in Deployment. \n 29 cameras in Images. \n 29 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodeEcu_15 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\nWarning in left_join(cameras, deployment): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 6 of `x` matches multiple rows in `y`.\nℹ Row 6 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nWarning in left_join(data1, image, by): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 470 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCodeEcu_16 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")\n\n28 cameras in Cameras. \n 28 cameras in Deployment. \n 28 deployments in Deployment. \n 28 points in Deployment. \n 28 cameras in Images. \n 28 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCode# get sites\nEcu_14_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\n\n\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_15_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_16_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCode# get elevation map\nelevation_14 &lt;- rast(get_elev_raster(Ecu_14_sites, z = 9))\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCodebb &lt;-  st_as_sfc(st_bbox(elevation_14)) # make bounding box \n\n\n\n# extract covs using points and add to _sites\ncovs_Ecu_14_sites &lt;- cbind(Ecu_14_sites, terra::extract(elevation_14, Ecu_14_sites))\n\ncovs_Ecu_15_sites &lt;- cbind(Ecu_15_sites, terra::extract(elevation_14, Ecu_15_sites))\n\ncovs_Ecu_16_sites &lt;- cbind(Ecu_16_sites, terra::extract(elevation_14, Ecu_16_sites))\n\n# get which are in and out\ncovs_Ecu_14_sites$in_AP = st_intersects(covs_Ecu_14_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_15_sites$in_AP = st_intersects(covs_Ecu_15_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_16_sites$in_AP = st_intersects(covs_Ecu_16_sites, AP_Llanganates, sparse = FALSE)\n\n\n\n# make a map\nmapview (elevation_14, alpha=0.5) + \n  mapview (AP_Llanganates, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Ecu_14_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  mapview (covs_Ecu_15_sites, zcol = \"in_AP\", burst = TRUE, col.regions = c(\"blue\") )+\n  mapview (covs_Ecu_16_sites, zcol = \"in_AP\", burst = TRUE, col.regions =c(\"red\",\"blue\")) \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 524288 to avoid this."
  },
  {
    "objectID": "posts/1st_model_1AP/index.html#multi-species-occupancy-model-using-spoccupancy",
    "href": "posts/1st_model_1AP/index.html#multi-species-occupancy-model-using-spoccupancy",
    "title": "Llanganates",
    "section": "",
    "text": "Codelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\nlibrary(spOccupancy)\nlibrary(bayesplot)\n#library(ggmcmc)\n\nlibrary(tidyverse)\n\n\n\n\n\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nCargando paquete requerido: camtrapR\n\nCodeAP_Llanganates &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Llanganates/WDPA_WDOECM_May2025_Public_97512_shp-polygons.shp\")\n\n### Ecu 14, Ecu 14  y Ecu 16\n\n# load data\nEcu_14 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\")\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 29 deployments in Deployment. \n 29 points in Deployment. \n 29 cameras in Images. \n 29 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodeEcu_15 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")\n\n29 cameras in Cameras. \n 29 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\nWarning in left_join(cameras, deployment): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 6 of `x` matches multiple rows in `y`.\nℹ Row 6 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nWarning in left_join(data1, image, by): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 470 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCodeEcu_16 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")\n\n28 cameras in Cameras. \n 28 cameras in Deployment. \n 28 deployments in Deployment. \n 28 points in Deployment. \n 28 cameras in Images. \n 28 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCode# get sites\nEcu_14_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-014.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\n\n\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_15_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-015.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_16_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-016.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCode# get elevation map\nelevation_14 &lt;- rast(get_elev_raster(Ecu_14_sites, z = 9))\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCodebb &lt;-  st_as_sfc(st_bbox(elevation_14)) # make bounding box \n\n\n\n# extract covs using points and add to _sites\ncovs_Ecu_14_sites &lt;- cbind(Ecu_14_sites, terra::extract(elevation_14, Ecu_14_sites))\n\ncovs_Ecu_15_sites &lt;- cbind(Ecu_15_sites, terra::extract(elevation_14, Ecu_15_sites))\n\ncovs_Ecu_16_sites &lt;- cbind(Ecu_16_sites, terra::extract(elevation_14, Ecu_16_sites))\n\n# get which are in and out\ncovs_Ecu_14_sites$in_AP = st_intersects(covs_Ecu_14_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_15_sites$in_AP = st_intersects(covs_Ecu_15_sites, AP_Llanganates, sparse = FALSE)\n\ncovs_Ecu_16_sites$in_AP = st_intersects(covs_Ecu_16_sites, AP_Llanganates, sparse = FALSE)\n\n\n\n# make a map\nmapview (elevation_14, alpha=0.5) + \n  mapview (AP_Llanganates, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Ecu_14_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  mapview (covs_Ecu_15_sites, zcol = \"in_AP\", burst = TRUE, col.regions = c(\"blue\") )+\n  mapview (covs_Ecu_16_sites, zcol = \"in_AP\", burst = TRUE, col.regions =c(\"red\",\"blue\")) \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 524288 to avoid this."
  },
  {
    "objectID": "posts/1st_model_1AP/index.html#detection-history",
    "href": "posts/1st_model_1AP/index.html#detection-history",
    "title": "Llanganates",
    "section": "Detection history",
    "text": "Detection history\n\nCode# check duplicateds in sites\nind1 &lt;- as.vector(which(table(Ecu_15_sites$Point)&gt;=2))# duplicated\nind &lt;- which(Ecu_15_sites$Point==ind1)# match\nEcu_15_sites &lt;- Ecu_15_sites[-ind,]# remove\n\n\n\nEcu_14_historias &lt;- wcs.det_history.creator(data=Ecu_14)\n\nCargando paquete requerido: hms\n\n\n\nAdjuntando el paquete: 'hms'\n\n\nThe following object is masked from 'package:lubridate':\n\n    hms\n\n\n51 days of sampling effort. \n 29 sampling sites. \n 25 species. \n\nCode# sp_number &lt;- which(names(Ecu_14_historias)==\"Tremarctos ornatus\")\nEcu_15_historias &lt;- wcs.det_history.creator(data=Ecu_15)\n\n53 days of sampling effort. \n 30 sampling sites. \n 13 species. \n\nCode# sp_number &lt;- which(names(Ecu_14_historias)==\"Tremarctos ornatus\")\nEcu_16_historias &lt;- wcs.det_history.creator(data=Ecu_16)\n\n106 days of sampling effort. \n 28 sampling sites. \n 16 species. \n\nCode# sp_number &lt;- which(names(Ecu_14_historias)==\"Tremarctos ornatus\")\n\n\n\n# make data frame for each\nlibrary (plyr)\n\n------------------------------------------------------------------------------\n\n\nYou have loaded plyr after dplyr - this is likely to cause problems.\nIf you need functions from both plyr and dplyr, please load plyr first, then dplyr:\nlibrary(plyr); library(dplyr)\n\n\n------------------------------------------------------------------------------\n\n\n\nAdjuntando el paquete: 'plyr'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    arrange, count, desc, failwith, id, mutate, rename, summarise,\n    summarize\n\n\nThe following object is masked from 'package:purrr':\n\n    compact\n\n\nThe following object is masked from 'package:maps':\n\n    ozone\n\nCodeEcu_14_df &lt;- ldply (Ecu_14_historias)\nEcu_14_df$site &lt;- paste(\"Ecu_14\", 1:29, sep=\"_\")#sites\nEcu_14_df$lat &lt;- rep(as.data.frame(st_coordinates(Ecu_14_sites))[,\"Y\"], 25) #sp\nEcu_14_df$lon &lt;- as.data.frame(st_coordinates(Ecu_14_sites))[,\"X\"]\n\n\nEcu_15_df &lt;- ldply (Ecu_15_historias)\nEcu_15_df$site &lt;- paste(\"Ecu_15\", 1:30, sep=\"_\")#site\nEcu_15_df$lat &lt;- rep(as.data.frame(st_coordinates(Ecu_15_sites))[,\"Y\"], 13) #sp\nEcu_15_df$lon &lt;- as.data.frame(st_coordinates(Ecu_15_sites))[,\"X\"]\n\n\nEcu_16_df &lt;- ldply (Ecu_16_historias)\nEcu_16_df$site &lt;- paste(\"Ecu_16\", 1:28, sep=\"_\")#site\nEcu_16_df$lat &lt;- rep(as.data.frame(st_coordinates(Ecu_16_sites))[,\"Y\"], 16) #sp\nEcu_16_df$lon &lt;- as.data.frame(st_coordinates(Ecu_16_sites))[,\"X\"]\n\n\n# rbind cuted by por 45 dias de muestreo\nEcu_14_15_16 &lt;- rbind(Ecu_14_df[,-(47:52)],\n                      Ecu_15_df[,-(47:54)],\n                      Ecu_16_df[,-(47:107)])\n\n# remove non species\n# filter(id != 2) # or filter(!id == 2)\nEcu_14_15_16 &lt;- Ecu_14_15_16 |&gt; \n                  filter(.id != \"Set up\" ) |&gt; \n                  filter(.id != \"Blank\" )  |&gt; \n                  filter(.id != \"Unknown\" )\n\n\n####################\n# Make empty array\n####################\n# Species codes.\nsp.codes &lt;- sort(unique(Ecu_14_15_16$.id))\n# Plot (site) codes.\nplot.codes &lt;- sort(unique(Ecu_14_15_16$site))\n# Number of species\nN &lt;- length(sp.codes)\n# Maximum number of replicates at a site\nK &lt;- 45\n# Number of sites\nJ &lt;- length(unique(Ecu_14_15_16$site))\n# Array for detection-nondetection data. \ny &lt;- array(NA, dim = c(N, J, K))\n# Label the dimensions of y (not necessary, but helpful)\ndimnames(y)[[1]] &lt;- sp.codes\ndimnames(y)[[2]] &lt;- plot.codes\n# Look at the structure of our array y\nstr(y)\n\n logi [1:35, 1:87, 1:45] NA NA NA NA NA NA ...\n - attr(*, \"dimnames\")=List of 3\n  ..$ : chr [1:35] \"Bos taurus\" \"Cabassous unicinctus\" \"Canis familiaris\" \"Chamaepetes goudotii\" ...\n  ..$ : chr [1:87] \"Ecu_14_1\" \"Ecu_14_10\" \"Ecu_14_11\" \"Ecu_14_12\" ...\n  ..$ : NULL\n\nCode########### feed the empty array\nfor (j in 1:J) { # Loop through sites.\n  for (k in 1:K) { # Loop through replicates at each site.\n    # Extract data for current site/replicate combination.\n    curr.df &lt;- Ecu_14_15_16 %&gt;%\n      filter(site == plot.codes[j])\n    # Check if more than one date for a given replicate\n    #if (n_distinct(curr.df$Date) &gt; 1) {\n      # If there is more than 1 date, only use the data\n      # from the first date.\n    #  curr.dates &lt;- unique(sort(curr.df$Date))\n    #  curr.df &lt;- curr.df %&gt;% \n     #   filter(Date == curr.dates[1])\n     #}\n    # If plot j was sampled during replicate k, \n    # curr.df will have at least 1 row (i.e., at least \n    # one species will be observed). If not, assume it \n    # was not sampled for that replicate.\n    if (nrow(curr.df) &gt; 0) {\n      # Extract the species that were observed during\n      # this site/replicate.\n      curr.sp &lt;- which(sp.codes %in% curr.df$.id)\n      # Set value to 1 for species that were observed.\n      y[curr.sp, j, k] &lt;- 1\n      # Set value to 0 for all other species.\n      y[-curr.sp, j, k] &lt;- 0\n    }\n  } # k (replicates)\n} # j (sites)\nstr(y)\n\n num [1:35, 1:87, 1:45] 0 1 1 1 0 1 0 1 1 0 ...\n - attr(*, \"dimnames\")=List of 3\n  ..$ : chr [1:35] \"Bos taurus\" \"Cabassous unicinctus\" \"Canis familiaris\" \"Chamaepetes goudotii\" ...\n  ..$ : chr [1:87] \"Ecu_14_1\" \"Ecu_14_10\" \"Ecu_14_11\" \"Ecu_14_12\" ...\n  ..$ : NULL\n\nCode# Total number of observations for each species\napply(y, 1, sum, na.rm = TRUE)\n\n              Bos taurus     Cabassous unicinctus         Canis familiaris \n                    1260                     1305                     1305 \n    Chamaepetes goudotii   Conepatus semistriatus           Cuniculus paca \n                    1305                     1260                     1305 \n  Cuniculus taczanowskii    Dasyprocta fuliginosa     Dasypus novemcinctus \n                    2610                     1305                     1305 \n      Didlephis pernigra             Eira barbara Hadrosciurus igniventris \n                    1260                     1305                     1305 \nHerpailurus yagouaroundi             Homo sapiens       Leopardus pardalis \n                    1305                     1305                     1305 \n      Leopardus tigrinus         Leopardus wiedii           Mazama murelia \n                    2610                     1305                     1305 \n           Mazama rufina            Mazama zamora        Nasuella olivacea \n                    2565                     1305                     2610 \n      Nothocrax urumutum         Odocoileus ustus            Panthera onca \n                    1305                     2610                     1305 \n           Pecari tajacu       Penelope montagnii     Pseudalopex culpaeus \n                    1305                     1260                     2610 \n     Pudu mephistophiles            Puma concolor       Sylvilagus andinus \n                    2610                     2610                     2610 \n       Tapirus pinchaque           Tayassu pecari            Tinamus major \n                    2610                     1305                     1305 \n      Tremarctos ornatus        Zentrygon frenata \n                    3915                     1305 \n\nCode# Union coordiantes all sites\nfull_sites_14_15_16 &lt;- as.data.frame(cbind(\n  lat=unique(Ecu_14$Latitude), \n  lon=unique(Ecu_14$Longitude) )) |&gt; \n                       rbind(as.data.frame(cbind(\n  lat=unique(Ecu_15$Latitude), \n  lon=unique(Ecu_15$Longitude) )))|&gt; \n            rbind(as.data.frame(cbind(\n  lat=unique(Ecu_16$Latitude), \n  lon=unique(Ecu_16$Longitude) )))\n\n# put name\nfull_sites_14_15_16$site &lt;- unique(Ecu_14_15_16$site)\n# make sf()\nfull_sites_14_15_16_sf = st_as_sf(full_sites_14_15_16, \n                                  coords = c(\"lon\", \"lat\"), \n                                  crs = 4326)\n\n# extract elev\nelev &lt;- terra::extract(elevation_14, full_sites_14_15_16_sf)[,2]\nstr(elev)\n\n num [1:87] 703 1155 726 620 1112 ...\n\nCode# extract in AP\nfull_sites_14_15_16_sf$in_AP = st_intersects(full_sites_14_15_16_sf, AP_Llanganates, sparse = FALSE)\n\nin_AP &lt;- as.numeric(as.vector(st_drop_geometry(full_sites_14_15_16_sf$in_AP)))\n\n# mapview(full_sites_14_15_16_sf, zcol = \"in_AP\", burst = TRUE)\n\n# Transform coord to UTM Z17 Ecuador EPSG:32717 WGS 84 / UTM zone 17S\n\nfull_sites_14_15_16_sf_UTM &lt;- st_transform(full_sites_14_15_16_sf, \"EPSG:32717\")\n\ncoords &lt;- st_coordinates(full_sites_14_15_16_sf_UTM)\nstr(coords)\n\n num [1:87, 1:2] 836104 831789 840323 836954 845679 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : NULL\n  ..$ : chr [1:2] \"X\" \"Y\"\n\nCode# make Ecu_14_15_16 an sf object\n#    cam_sf &lt;- st_as_sf(Ecu_14_15_16, coords = c(\"lon\",\"lat\"))   #crs=\"EPSG:4326\")\n    #--- set CRS ---#\n#    st_crs(cam_sf) &lt;- 4326\n\n#transform llanganates\nAP_Llanganates_UTM &lt;- st_transform(AP_Llanganates, \"EPSG:32717\")\n# Convert to LINESTRING\nAP_Llanganates_UTM_line &lt;- st_cast(AP_Llanganates_UTM, \"LINESTRING\")\n\nWarning in st_cast.sf(AP_Llanganates_UTM, \"LINESTRING\"): repeating attributes\nfor all sub-geometries for which they may not be constant\n\nCode# Calculate the distance\n#multiplic &lt;- full_sites_14_15_16_sf_UTM |&gt; mutate(multiplic= as.numeric(in_AP)) \nmultiplic=ifelse(full_sites_14_15_16_sf_UTM$in_AP==\"TRUE\",-1,1)\nborder_dist &lt;- st_distance(full_sites_14_15_16_sf_UTM, AP_Llanganates_UTM_line) * multiplic \n# print(border_dist)"
  },
  {
    "objectID": "posts/1st_model_1AP/index.html#pack-in-object",
    "href": "posts/1st_model_1AP/index.html#pack-in-object",
    "title": "Llanganates",
    "section": "pack in object",
    "text": "pack in object\n\nCode# Detection-nondetection data ---------\n# Species of interest, can select individually\ncurr.sp &lt;- sort(unique(Ecu_14_15_16$.id))# c('BAWW', 'BLJA', 'GCFL')\ny.msom &lt;- y[which(sp.codes %in% curr.sp), , ]\nstr(y.msom)\n\n num [1:35, 1:87, 1:45] 0 1 1 1 0 1 0 1 1 0 ...\n - attr(*, \"dimnames\")=List of 3\n  ..$ : chr [1:35] \"Bos taurus\" \"Cabassous unicinctus\" \"Canis familiaris\" \"Chamaepetes goudotii\" ...\n  ..$ : chr [1:87] \"Ecu_14_1\" \"Ecu_14_10\" \"Ecu_14_11\" \"Ecu_14_12\" ...\n  ..$ : NULL\n\nCode# Distances between sites\ndist.hbef &lt;- dist(coords)\n\n# Detection covariates ----------------\n# det.covs &lt;- list(day = hb.day, \n#                 tod = hb.tod)\n# str(det.covs)\n\n# Occurrence covariates ---------------\nocc.covs &lt;- data.frame(elev, as.factor(in_AP), border_dist)\n\nnames(occ.covs) &lt;- c(\"elev\", \"in_AP\", \"border_dist\")\nstr(occ.covs)\n\n'data.frame':   87 obs. of  3 variables:\n $ elev       : num  703 1155 726 620 1112 ...\n $ in_AP      : Factor w/ 2 levels \"0\",\"1\": 1 1 1 1 1 2 1 1 2 1 ...\n $ border_dist: Units: [m] num  399 1749 5432 1255 17612 ...\n\nCode# pack all\n\n# Package all data into list object\ndata.msom &lt;- list(y = y.msom, \n                  occ.covs = occ.covs, \n                  #det.covs = det.covs, \n                  coords = coords)\n\n#### Inits\nms.inits &lt;- list(alpha.comm = 0, \n                 beta.comm = 0, \n                 beta = 0, \n                 alpha = 0,\n                 tau.sq.beta = 1, \n                 tau.sq.alpha = 1, \n                 z = apply(y.msom, c(1, 2), max, na.rm = TRUE), \n                 sigma.sq = 2, \n                 phi = 3 / mean(dist.hbef), \n                 w = matrix(0, N, dim(y.msom)[2])\n                 )\n\n# priors\n# Minimum value is 0, so need to grab second element.\nmin.dist &lt;- sort(unique(dist.hbef))[2]\nmax.dist &lt;- max(dist.hbef)\nms.priors &lt;- list(beta.comm.normal = list(mean = 0, var = 2.72),\n                  alpha.comm.normal = list(mean = 0, var = 2.72), \n                  tau.sq.beta.ig = list(a = 0.1, b = 0.1), \n                  tau.sq.alpha.ig = list(a = 0.1, b = 0.1),\n                  sigma.sq.ig = list(a = 2, b = 2), \n                  phi.unif = list(a = 3 / max.dist, b = 3 / min.dist))\n\n\n# We next set the parameters controlling the Adaptive MCMC algorithm\nbatch.length &lt;- 25\nn.batch &lt;- 500\nn.burn &lt;- 2000\nn.thin &lt;- 20\nn.chains &lt;- 3\nms.tuning &lt;- list(phi = 0.5)\nn.omp.threads &lt;- 3 # procesadores\n# Values for reporting\nverbose &lt;- TRUE\nn.report &lt;- 1000\n\n\n\nout.msom &lt;- spMsPGOcc(occ.formula = ~ scale(elev) + scale(border_dist) + factor(in_AP), \n                      det.formula = ~1,# ~ scale(day) + I(scale(day)^2) + scale(tod), \n                      data = data.msom,\n                      inits = ms.inits,\n                      n.burn = n.burn,\n                      n.batch = n.batch, \n                      batch.length = batch.length, \n                      accept.rate = 0.43,\n                      priors = ms.priors,\n                      n.omp.threads = n.omp.threads,\n                      n.chains = n.chains,\n                      cov.model = 'exponential', \n                      tuning = ms.tuning, \n                      NNGP = TRUE, \n                      verbose = TRUE,\n                      n.report = n.report,\n                      n.neighbors = 5, \n                      n.thin = n.thin\n                      \n                      ) \n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\ndetection covariates (det.covs) not specified in data.\nAssuming interept only detection model.\n\n\n----------------------------------------\n    Building the neighbor list\n----------------------------------------\n----------------------------------------\nBuilding the neighbors of neighbors list\n----------------------------------------\n----------------------------------------\n    Model description\n----------------------------------------\nNNGP Multi-species Occupancy Model with Polya-Gamma latent\nvariable fit with 87 sites and 35 species.\n\nSamples per chain: 12500 (500 batches of length 25)\nBurn-in: 2000 \nThinning Rate: 20 \nNumber of Chains: 3 \nTotal Posterior Samples: 1575 \n\nUsing the exponential spatial correlation model.\n\nUsing 5 nearest neighbors.\n\nSource compiled with OpenMP support and model fit using 3 thread(s).\n\nAdaptive Metropolis with target acceptance rate: 43.0\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nBatch: 500 of 500, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nBatch: 500 of 500, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nBatch: 500 of 500, 100.00%\n\nCodesummary(out.msom, level = 'community')\n\n\nCall:\nspMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist) + factor(in_AP), \n    det.formula = ~1, data = data.msom, inits = ms.inits, priors = ms.priors, \n    tuning = ms.tuning, cov.model = \"exponential\", NNGP = TRUE, \n    n.neighbors = 5, n.batch = n.batch, batch.length = batch.length, \n    accept.rate = 0.43, n.omp.threads = n.omp.threads, verbose = TRUE, \n    n.report = n.report, n.burn = n.burn, n.thin = n.thin, n.chains = n.chains)\n\nSamples per Chain: 12500\nBurn-in: 2000\nThinning Rate: 20\nNumber of Chains: 3\nTotal Posterior Samples: 1575\nRun Time (min): 35.8275\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%  97.5%   Rhat  ESS\n(Intercept)        -1.3478 1.4047 -3.9942 -1.3984 1.5530 1.0066 1064\nscale(elev)        -0.5219 1.6427 -3.8868 -0.5412 2.6766 1.0053 1247\nscale(border_dist)  1.7558 1.5070 -1.2375  1.7897 4.6745 1.0300  257\nfactor(in_AP)1     -0.3494 1.0975 -2.4802 -0.4121 1.8164 1.0804  201\n\nOccurrence Variances (logit scale): \n                        Mean       SD      2.5%       50%     97.5%   Rhat ESS\n(Intercept)         196.1323  88.3239   77.6407  177.9674  421.3906 1.3780  34\nscale(elev)        2234.6922 832.9309 1011.8161 2099.1955 4191.8606 1.3125  43\nscale(border_dist)   50.7356  29.1487   10.6616   45.7375  121.1854 1.0718 160\nfactor(in_AP)1        1.6222   3.2229    0.0547    0.5841    9.1775 1.0074 710\n\nDetection Means (logit scale): \n              Mean     SD   2.5%    50%   97.5%   Rhat ESS\n(Intercept) 9.8136 0.5259 8.8727 9.7736 10.8807 1.3189  22\n\nDetection Variances (logit scale): \n              Mean     SD   2.5%   50%  97.5%   Rhat ESS\n(Intercept) 0.4159 0.4369 0.0395 0.267 1.7283 1.0529  82\n\nCode# Posterior predictive checks\n# Approx. run time: 20 sec\n# ppc.ms.out &lt;- ppcOcc(out.msom, 'chi-squared', group = 1)\n# summary(ppc.ms.out)\n\n# Takes a few seconds to run.\nppc.sp.ms.out &lt;- ppcOcc(out.msom, 'freeman-tukey', group = 2)\n\nCurrently on species 1 out of 35\n\n\nCurrently on species 2 out of 35\n\n\nCurrently on species 3 out of 35\n\n\nCurrently on species 4 out of 35\n\n\nCurrently on species 5 out of 35\n\n\nCurrently on species 6 out of 35\n\n\nCurrently on species 7 out of 35\n\n\nCurrently on species 8 out of 35\n\n\nCurrently on species 9 out of 35\n\n\nCurrently on species 10 out of 35\n\n\nCurrently on species 11 out of 35\n\n\nCurrently on species 12 out of 35\n\n\nCurrently on species 13 out of 35\n\n\nCurrently on species 14 out of 35\n\n\nCurrently on species 15 out of 35\n\n\nCurrently on species 16 out of 35\n\n\nCurrently on species 17 out of 35\n\n\nCurrently on species 18 out of 35\n\n\nCurrently on species 19 out of 35\n\n\nCurrently on species 20 out of 35\n\n\nCurrently on species 21 out of 35\n\n\nCurrently on species 22 out of 35\n\n\nCurrently on species 23 out of 35\n\n\nCurrently on species 24 out of 35\n\n\nCurrently on species 25 out of 35\n\n\nCurrently on species 26 out of 35\n\n\nCurrently on species 27 out of 35\n\n\nCurrently on species 28 out of 35\n\n\nCurrently on species 29 out of 35\n\n\nCurrently on species 30 out of 35\n\n\nCurrently on species 31 out of 35\n\n\nCurrently on species 32 out of 35\n\n\nCurrently on species 33 out of 35\n\n\nCurrently on species 34 out of 35\n\n\nCurrently on species 35 out of 35\n\nCodesummary(ppc.sp.ms.out, level = 'both')\n\n\nCall:\nppcOcc(object = out.msom, fit.stat = \"freeman-tukey\", group = 2)\n\nSamples per Chain: 12500\nBurn-in: 2000\nThinning Rate: 20\nNumber of Chains: 3\nTotal Posterior Samples: 1575\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.1087 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nBos taurus Bayesian p-value: 0.08\nCabassous unicinctus Bayesian p-value: 0.0844\nCanis familiaris Bayesian p-value: 0.0819\nChamaepetes goudotii Bayesian p-value: 0.0895\nConepatus semistriatus Bayesian p-value: 0.0952\nCuniculus paca Bayesian p-value: 0.0952\nCuniculus taczanowskii Bayesian p-value: 0.1581\nDasyprocta fuliginosa Bayesian p-value: 0.0952\nDasypus novemcinctus Bayesian p-value: 0.0857\nDidlephis pernigra Bayesian p-value: 0.0959\nEira barbara Bayesian p-value: 0.073\nHadrosciurus igniventris Bayesian p-value: 0.0711\nHerpailurus yagouaroundi Bayesian p-value: 0.0698\nHomo sapiens Bayesian p-value: 0.0832\nLeopardus pardalis Bayesian p-value: 0.0851\nLeopardus tigrinus Bayesian p-value: 0.1619\nLeopardus wiedii Bayesian p-value: 0.0895\nMazama murelia Bayesian p-value: 0.0832\nMazama rufina Bayesian p-value: 0.1327\nMazama zamora Bayesian p-value: 0.0889\nNasuella olivacea Bayesian p-value: 0.1568\nNothocrax urumutum Bayesian p-value: 0.0737\nOdocoileus ustus Bayesian p-value: 0.1651\nPanthera onca Bayesian p-value: 0.073\nPecari tajacu Bayesian p-value: 0.0997\nPenelope montagnii Bayesian p-value: 0.0857\nPseudalopex culpaeus Bayesian p-value: 0.1632\nPudu mephistophiles Bayesian p-value: 0.1606\nPuma concolor Bayesian p-value: 0.1619\nSylvilagus andinus Bayesian p-value: 0.1479\nTapirus pinchaque Bayesian p-value: 0.1498\nTayassu pecari Bayesian p-value: 0.0876\nTinamus major Bayesian p-value: 0.0819\nTremarctos ornatus Bayesian p-value: 0.2121\nZentrygon frenata Bayesian p-value: 0.0863\nFit statistic:  freeman-tukey \n\n\n\nCode### plots\n# plot(out.msom, 'alpha', density = FALSE) # Detection parameters.\n# mcmc_intervals(out$alpha.comm.samples)\n# mcmc_intervals(out$alpha.samples)\n\n# plot(out.msom, 'beta', density = TRUE) # Occupancy parameters.\nmcmc_intervals(out.msom$beta.comm.samples)\n\n\n\n\n\n\nCodemcmc_intervals(out.msom$beta.samples)\n\n\n\n\n\n\nCode# occupancy per species\nmcmc_areas(out.msom$beta.samples, \n  pars = c(\"scale(border_dist)-Tapirus pinchaque\", \"scale(border_dist)-Cuniculus paca\", \"scale(border_dist)-Mazama rufina\", \"scale(border_dist)-Puma concolor\", \"scale(border_dist)-Canis familiaris\"))"
  },
  {
    "objectID": "posts/1st_model_1AP/index.html#package-citation",
    "href": "posts/1st_model_1AP/index.html#package-citation",
    "title": "Llanganates",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R version 4.4.2 (R Core Team 2024) and the following R packages: bayesplot v. 1.11.1 (Gabry et al. 2019; Gabry and Mahr 2024), camtrapR v. 2.3.0 (Niedballa et al. 2016), DT v. 0.33 (Xie, Cheng, and Tan 2024), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.2.1 (Richard A. Becker, Ray Brownrigg. Enhancements by Thomas P Minka, and Deckmyn. 2024), mapview v. 2.11.2 (Appelhans et al. 2023), plyr v. 1.8.9 (Wickham 2011), sf v. 1.0.19 (Pebesma 2018; Pebesma and Bivand 2023), spOccupancy v. 0.8.0 (Doser et al. 2022, 2024; Doser, Finley, and Banerjee 2023), terra v. 1.8.21 (Hijmans 2025), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.0 (Tennekes 2018)."
  },
  {
    "objectID": "posts/1st_model_1AP/index.html#sesion-info",
    "href": "posts/1st_model_1AP/index.html#sesion-info",
    "title": "Llanganates",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: internal\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] plyr_1.8.9        hms_1.1.3         camtrapR_2.3.0    lubridate_1.9.4  \n [5] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2      \n [9] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    \n[13] tidyverse_2.0.0   bayesplot_1.11.1  spOccupancy_0.8.0 elevatr_0.99.0   \n[17] terra_1.8-21      tmap_4.0          maps_3.4.2.1      mapview_2.11.2   \n[21] sf_1.0-19         DT_0.33           readxl_1.4.3      grateful_0.2.10  \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3      tensorA_0.36.2.1        rstudioapi_0.17.1      \n  [4] jsonlite_1.8.9          wk_0.9.4                magrittr_2.0.3         \n  [7] farver_2.1.2            nloptr_2.1.1            rmarkdown_2.29         \n [10] vctrs_0.6.5             minqa_1.2.8             base64enc_0.1-3        \n [13] RcppNumerical_0.6-0     htmltools_0.5.8.1       leafsync_0.1.0         \n [16] progress_1.2.3          distributional_0.5.0    curl_6.0.0             \n [19] raster_3.6-30           cellranger_1.1.0        s2_1.1.7               \n [22] slippymath_0.3.1        KernSmooth_2.23-24      htmlwidgets_1.6.4      \n [25] stars_0.6-8             uuid_1.2-1              lifecycle_1.0.4        \n [28] iterators_1.0.14        pkgconfig_2.0.3         cols4all_0.8           \n [31] Matrix_1.7-1            R6_2.6.1                fastmap_1.2.0          \n [34] digest_0.6.37           colorspace_2.1-1        leafem_0.2.3           \n [37] crosstalk_1.2.1         labeling_0.4.3          lwgeom_0.2-14          \n [40] progressr_0.15.0        spacesXYZ_1.3-0         timechange_0.3.0       \n [43] httr_1.4.7              abind_1.4-8             mgcv_1.9-1             \n [46] compiler_4.4.2          microbenchmark_1.5.0    proxy_0.4-27           \n [49] withr_3.0.2             doParallel_1.0.17       backports_1.5.0        \n [52] brew_1.0-10             DBI_1.2.3               MASS_7.3-61            \n [55] tmaptools_3.2           leaflet_2.2.2           classInt_0.4-10        \n [58] tools_4.4.2             units_0.8-5             leaflegend_1.2.1       \n [61] glue_1.8.0              satellite_1.0.5         nlme_3.1-166           \n [64] grid_4.4.2              checkmate_2.3.2         reshape2_1.4.4         \n [67] generics_0.1.3          gtable_0.3.6            leaflet.providers_2.0.0\n [70] tzdb_0.4.0              class_7.3-22            data.table_1.16.4      \n [73] sp_2.1-4                RANN_2.6.2              foreach_1.5.2          \n [76] pillar_1.10.1           posterior_1.6.1         splines_4.4.2          \n [79] lattice_0.22-6          tidyselect_1.2.1        knitr_1.49             \n [82] svglite_2.1.3           stats4_4.4.2            xfun_0.49              \n [85] leafpop_0.1.0           stringi_1.8.4           rematch_2.0.0          \n [88] yaml_2.3.10             boot_1.3-31             evaluate_1.0.1         \n [91] codetools_0.2-20        cli_3.6.3               RcppParallel_5.1.9     \n [94] systemfonts_1.1.0       munsell_0.5.1           jquerylib_0.1.4        \n [97] secr_5.1.0              dichromat_2.0-0.1       Rcpp_1.0.13-1          \n[100] spAbundance_0.2.1       coda_0.19-4.1           png_0.1-8              \n[103] XML_3.99-0.17           parallel_4.4.2          prettyunits_1.2.0      \n[106] lme4_1.1-35.5           viridisLite_0.4.2       mvtnorm_1.3-2          \n[109] ggridges_0.5.6          scales_1.3.0            e1071_1.7-16           \n[112] crayon_1.5.3            rlang_1.1.4"
  },
  {
    "objectID": "posts/The-Model/index.html",
    "href": "posts/The-Model/index.html",
    "title": "The problem",
    "section": "",
    "text": "Codelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\nlibrary(unmarked)\nlibrary(ubms)\n\nlibrary(tidyverse)\nWe want to Asses the role of Protected Areas in the conservation of vertebrates using on the ground data.\nEvaluating whther PA are working is essential as they are perhaps the primary strategy for averting biodiversity loss. Its been suggested that some do no work, paper parks Its crucial to continue working on best methods to evaluate their impact.\nOver a decade ago researchers started evaluting this. Mostly focused on the effects of PA in reducing threats (fires, deforestation) and focused on forest cover.\nEven if effective in protecting forests, and the forest is in very good conditioon, PA could have “empty forests” and lose biodiversity (hunting, diseases or even their sizes). So when we say a PA is effective, are we looking at this?\nWe want to compare apples with apples and control for covariates related with occurence and abundance of species, like elevation, human pressures, etc.\nOccupancyis a cost effective method for evaluation the a population, a state variable, representing the proportion of the área occupied by the species, considering the problem of imperfect detection\nWe compiled studies that have intentionally sampled inside and outside PAS, in a quasi-experimental design, using standardized methods. Each case is adequatly matched, in a similar fashion as the remote sensing approaches.\nWe used a multispecies occupancy model incorporatind spatial autocorrelation to compare occupancy in and out and also as a distance to the protected area border.\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "posts/The-Model/index.html#package-citation",
    "href": "posts/The-Model/index.html#package-citation",
    "title": "The problem",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R version 4.4.2 (R Core Team 2024) and the following R packages: DT v. 0.33 (Xie, Cheng, and Tan 2024), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.2.1 (Richard A. Becker, Ray Brownrigg. Enhancements by Thomas P Minka, and Deckmyn. 2024), mapview v. 2.11.2 (Appelhans et al. 2023), sf v. 1.0.19 (Pebesma 2018; Pebesma and Bivand 2023), terra v. 1.8.21 (Hijmans 2025), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.0 (Tennekes 2018), ubms v. 1.2.7 (Kellner et al. 2021), unmarked v. 1.4.3 (Fiske and Chandler 2011; Kellner et al. 2023)."
  },
  {
    "objectID": "posts/The-Model/index.html#sesion-info",
    "href": "posts/The-Model/index.html#sesion-info",
    "title": "The problem",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.4 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n [5] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n [9] ggplot2_3.5.1   tidyverse_2.0.0 ubms_1.2.7      unmarked_1.4.3 \n[13] elevatr_0.99.0  terra_1.8-21    tmap_4.0        maps_3.4.2.1   \n[17] mapview_2.11.2  sf_1.0-19       DT_0.33         readxl_1.4.3   \n[21] grateful_0.2.10\n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3               pbapply_1.7-2           gridExtra_2.3          \n [4] tmaptools_3.2           s2_1.1.7                inline_0.3.20          \n [7] rlang_1.1.4             magrittr_2.0.3          matrixStats_1.5.0      \n[10] e1071_1.7-16            compiler_4.4.2          loo_2.8.0              \n[13] png_0.1-8               vctrs_0.6.5             pkgconfig_2.0.3        \n[16] wk_0.9.4                fastmap_1.2.0           lwgeom_0.2-14          \n[19] leafem_0.2.3            rmarkdown_2.29          tzdb_0.4.0             \n[22] spacesXYZ_1.3-0         xfun_0.49               satellite_1.0.5        \n[25] jsonlite_1.8.9          parallel_4.4.2          R6_2.6.1               \n[28] stringi_1.8.4           RColorBrewer_1.1-3      StanHeaders_2.32.10    \n[31] cellranger_1.1.0        stars_0.6-8             Rcpp_1.0.13-1          \n[34] rstan_2.32.6            knitr_1.49              base64enc_0.1-3        \n[37] leaflet.providers_2.0.0 timechange_0.3.0        Matrix_1.7-1           \n[40] tidyselect_1.2.1        rstudioapi_0.17.1       dichromat_2.0-0.1      \n[43] abind_1.4-8             yaml_2.3.10             codetools_0.2-20       \n[46] curl_6.0.0              pkgbuild_1.4.5          lattice_0.22-6         \n[49] leafsync_0.1.0          withr_3.0.2             evaluate_1.0.1         \n[52] units_0.8-5             proxy_0.4-27            RcppParallel_5.1.9     \n[55] pillar_1.10.1           KernSmooth_2.23-24      stats4_4.4.2           \n[58] generics_0.1.3          sp_2.1-4                hms_1.1.3              \n[61] rstantools_2.4.0        munsell_0.5.1           scales_1.3.0           \n[64] class_7.3-22            glue_1.8.0              tools_4.4.2            \n[67] leaflegend_1.2.1        data.table_1.16.4       RSpectra_0.16-2        \n[70] XML_3.99-0.17           grid_4.4.2              QuickJSR_1.4.0         \n[73] crosstalk_1.2.1         colorspace_2.1-1        cols4all_0.8           \n[76] raster_3.6-30           cli_3.6.3               viridisLite_0.4.2      \n[79] V8_6.0.0                gtable_0.3.6            digest_0.6.37          \n[82] progressr_0.15.0        classInt_0.4-10         htmlwidgets_1.6.4      \n[85] htmltools_0.5.8.1       lifecycle_1.0.4         leaflet_2.2.2          \n[88] microbenchmark_1.5.0    MASS_7.3-61"
  }
]